{% for rtr in routers -%}
set system host-name {{rtr}}
set system root-authentication encrypted-password "{{routers[rtr]['local_administrator'].password}}"
set system login user {{routers[rtr]['local_administrator'].username}} full-name {{routers[rtr]['local_administrator'].username}}
set system login user {{routers[rtr]['local_administrator'].username}} class {{routers[rtr]['local_administrator'].class}}
set system login user {{routers[rtr]['local_administrator'].username}} authentication encrypted-password "{{routers[rtr]['local_administrator'].password}}"
set system services ssh
set system services netconf ssh
set system services web-management http interface {{routers[rtr].management_interface}} 
set system syslog user * any emergency
set system syslog file messages any any
set system syslog file messages authorization info
set system syslog file interactive-commands interactive-commands any
set security forwarding-options family inet6 mode packet-based
set security forwarding-options family mpls mode packet-based
set security forwarding-options family iso mode packet-based
set interfaces {{routers[rtr].management_interface}} description lab-mgmt
set interfaces {{routers[rtr].management_interface}} unit 0 family inet address {{routers[rtr].mangement_address}}
set interfaces {{routers[rtr]['data_interface']['physical']}} description lab-data
set interfaces {{routers[rtr]['data_interface']['physical']}} unit 0 family ethernet-switching interface-mode trunk
    {% for link in routers[rtr]['data_interface']['irb'] -%}
set interfaces {{routers[rtr]['data_interface']['physical']}} unit 0 family ethernet-switching vlan members link{{link}}
set interfaces irb unit {{link}} family inet address 10.100.{{link}}.{{rtr[-2:]}}/24
set interfaces irb unit {{link}} description link-connecting:{{routers[rtr]['data_interface']['irb'][link]['members']|join(',')}}
set vlans link{{link}} vlan-id {{link}}
set vlans link{{link}} l3-interface irb.{{link}}
    {% endfor %}



{% endfor %}


